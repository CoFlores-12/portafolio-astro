---
// src/components/Certificates.astro
import CertificateCard from './CertificateCard.astro';

const certificates = [
  {
    id: 1,
    title: 'CCNAv7',
    issuer: 'Cisco',
    date: 'Dic 2023',
    image: '/assets/certify/CCNA.png',
    description: 'CCNAv7 Introducción a redes'
  },
  {
    id: 2,
    title: 'Python data structures',
    issuer: 'University of Michigan',
    date: 'Mar 2022',
    image: '/assets/certify/python.png',
    description: 'Python data structure'
  },
  {
    id: 3,
    title: 'Ciberseguridad',
    issuer: 'Cisco',
    date: 'Jun 2021',
    image: '/assets/certify/CS.jpg',
    description: 'Ciberseguridad'
  },
  {
    id: 4,
    title: 'Proyecto COIL',
    issuer: 'Universidad la salle',
    date: 'Nov 2024',
    image: '/assets/certify/IA.jpg',
    description: 'Proyecto IA'
  },
  {
    id: 5,
    title: 'Excelencia Académica 2020',
    issuer: 'Universidad Nacional Autónoma de Honduras',
    date: '2020',
    image: '/assets/certify/EA2020.jpg',
    description: 'Excelencia Académica 2020'
  },
  {
    id: 6,
    title: 'Excelencia Académica 2021',
    issuer: 'Universidad Nacional Autónoma de Honduras',
    date: '2021',
    image: '/assets/certify/EA2021.jpg',
    description: 'Excelencia Académica 2021'
  },
  {
    id: 5,
    title: 'Excelencia Académica 2022',
    issuer: 'Universidad Nacional Autónoma de Honduras',
    date: '2022',
    image: '/assets/certify/EA2022.jpg',
    description: 'Excelencia Académica 2022'
  },
  {
    id: 6,
    title: 'Excelencia Académica 2023',
    issuer: 'Universidad Nacional Autónoma de Honduras',
    date: '2023',
    image: '/assets/certify/EA2023.jpg',
    description: 'Excelencia Académica 2023'
  },
  // ... más certificados ...
];

let currentIndex = 0;
---

<section id="certificates" class="certificates-section">
  <div class="container">
    <h2 class="section-title">Mis <span class="highlight">Certificados y Reconocimientos</span></h2>
    <p class="section-subtitle">
      Documentación de mi aprendizaje continuo y logros profesionales
    </p>

    <div class="carousel-container">
      <button class="carousel-btn prev" onclick="moveCarousel(-1)">‹</button>
      
      <div class="carousel">
        {certificates.map((certificate, index) => (
          <CertificateCard 
            certificate={certificate} 
            index={index} 
          />
        ))}
      </div>
      
      <button class="carousel-btn next" onclick="moveCarousel(1)">›</button>
    </div>

    <div class="carousel-dots">
      {certificates.map((_, index) => (
        <span 
          class={`dot ${index === currentIndex ? 'active' : ''}`}
          onclick={`goToSlide(${index})`}
        ></span>
      ))}
    </div>
  </div>
</section>

<!-- Modal para imagen grande -->
<div id="certificateModal" class="modal">
  <span class="close-modal" onclick="closeModal()">&times;</span>
  <img class="modal-content" id="modalImage">
  <div class="modal-caption" id="modalCaption"></div>
</div>

<style>
  .certificates-section {
    padding: 5rem 0;
    background: #f9f9f9;
    overflow: hidden;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1.5rem;
    position: relative;
  }

  .section-title {
    font-size: 2.5rem;
    text-align: center;
    margin-bottom: 1rem;
    color: #2c3e50;
  }

  .section-subtitle {
    text-align: center;
    color: #7f8c8d;
    margin-bottom: 3rem;
    font-size: 1.1rem;
  }

  .carousel-container {
    position: relative;
    display: flex;
    align-items: center;
    margin: 2rem 0;
  }

  .carousel {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    width: 100%;
    gap: 1.5rem;
    padding: 1rem 0;
  }

  .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: #2563eb;
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 1.5rem;
    cursor: pointer;
    z-index: 2;
    transition: all 0.3s ease;
  }

  .carousel-btn:hover {
    background: #2563eb;
  }

   .section-title {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 3rem;
    color: var(--dark);
    position: relative;
    display: inline-block;
  }

  .section-title .highlight {
    color: var(--primary);
    position: relative;
  }

  .section-title .highlight::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
    border-radius: 3px;
  }
  .prev {
    left: -20px;
  }

  .next {
    right: -20px;
  }

  .carousel-dots {
    text-align: center;
    margin-top: 1rem;
  }

  .dot {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ccc;
    margin: 0 5px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .dot.active {
    background: #2563eb;
  }

  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.9);
    overflow: auto;
  }

  .modal-content {
    margin: auto;
    display: block;
    max-width: 90%;
    max-height: 80vh;
    margin-top: 5vh;
  }

  .close-modal {
    position: absolute;
    top: 20px;
    right: 35px;
    color: white;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
  }

  .modal-caption {
    color: white;
    text-align: center;
    padding: 10px 0;
    max-width: 80%;
    margin: 0 auto;
  }

  @media (max-width: 768px) {
    .carousel-btn {
      width: 30px;
      height: 30px;
      font-size: 1rem;
    }
    
    .prev {
      left: -15px;
    }
    
    .next {
      right: -15px;
    }
  }
</style>

<script is:inline>
  let currentSlide = 0;
  const slides = document.querySelectorAll('.certificate-card');
  const dots = document.querySelectorAll('.dot');
  const modal = document.getElementById('certificateModal');
  const modalImg = document.getElementById('modalImage');
  const captionText = document.getElementById('modalCaption');

  // Inicializar carrusel
  document.addEventListener('DOMContentLoaded', () => {
    showSlide(currentSlide);
    startAutoSlide();
  });

  function moveCarousel(n) {
    showSlide(currentSlide += n);
    resetAutoSlide();
  }

  function goToSlide(n) {
    showSlide(currentSlide = n);
    resetAutoSlide();
  }

  function showSlide(n) {
    if (n >= slides.length) currentSlide = 0;
    if (n < 0) currentSlide = slides.length - 1;
    
    const carousel = document.querySelector('.carousel');
    carousel.scrollTo({
      left: slides[currentSlide].offsetLeft - carousel.offsetWidth / 2 + slides[currentSlide].offsetWidth / 2,
      behavior: 'smooth'
    });
    
    updateDots();
  }

  function updateDots() {
    dots.forEach((dot, index) => {
      dot.classList.toggle('active', index === currentSlide);
    });
  }

  function openModal(imgSrc, title, description) {
    modal.style.display = "block";
    modalImg.src = imgSrc;
    modalImg.alt = title;
    captionText.innerHTML = `<h3>${title}</h3><p>${description}</p>`;
    document.body.style.overflow = "hidden";
  }

  function closeModal() {
    modal.style.display = "none";
    document.body.style.overflow = "auto";
  }

  // Cerrar modal al hacer click fuera
  window.onclick = function(event) {
    if (event.target === modal) {
      closeModal();
    }
  }

  // Auto slide
  let slideInterval;
  function startAutoSlide() {
    slideInterval = setInterval(() => {
      moveCarousel(1);
    }, 5000);
  }

  function resetAutoSlide() {
    clearInterval(slideInterval);
    startAutoSlide();
  }
</script>